쿠버네티스 복습 1일차
----------------

마스터 노드
0. kubectl
클러스터에 명령을 내리는 역할
API 서버와 주로 통신하므로 API 서버가 위치한 노드에 구성된다.

1. API 서버
주로 상태값을 저장하는 etcd와 통신하지만, API 서버를 중심에 두고 통신.

2. etcd
구성 요소들의 상태 값이 모두 저장되는 곳
etcd의 정보만 백업돼 있으면 긴급상황에 클러스터 복구가 가능하다.
etcd는 분산 저장이 가능한 key-value 저장소이므로 복제해 여러 곳에 저장해 두면 하나의 etcd가 장애가 나더라도 시스템의 가용성을 확보할 수 있다.

3. 컨트롤러 매니저
클러스터의 오브젝트 상태를 관리한다.
컨트롤러 매니저의 종류는 다양
ex)
- 노드 컨트롤러
워커 노드에서 통신이 되지 않는 경우, 상태 체크와 복구
- 레플리카셋 컨트롤러
레플리카셋에 요청받은 파드 개수대로 파드 생성
- 엔드포인트 컨트롤러
서비스와 파드를 연결하는 역할

4. 스케줄러
노드의 상태와 자원, 레이블, 요구 조건 등을 고려해 파드를 어떤 워커 노드에 생성할 것인지 결정하고 할당한다.

워커노드
1. kubelet
파드의 구성내용을 받아서 컨테이너 런타임으로 전달, 파드 안의 컨테이너들이 정상적으로 작동하는지 모니터링
파드의 생성과 상태관리 및 복구 등을 담당하는 중요한 구성요소 이다.

2. 컨테이너 런타임
파드를 이루는 컨테이너의 실행 담당.
파드 안에 여러 컨테이너가 잘 작동하게 만드는 표준 인터페이스

3. 파드
한 개 이상의 컨테이너로 단일 목적의 일을 하기 위해서 모인 단위.

---

pod 생성하는 3가지 방법
```
kubectl run pod
kubectl create -f deployment ___.yaml
kubectl apply -f deployment ___.yaml
```
1. run
단일 pod 생성

2. create
deployment파일.yaml을 작성해 사용자가 원하는 상태로 쿠버네티스 오브젝트를
생성할 수 있지만 변경사항이 생길경우 파일의 변경사항을 바로 적용할 수 없다.

3. apply
deployment파일.yaml을 작성해 사용자가 원하는 상태로 쿠버네티스 오브젝트를 생성할 수 있다.
변경사항이 생길경우 파일의 변경사항을 바로 적용할 수 있다.
따라서, 변경이 생길 가능성이 있는 복잡한 오브젝트는 파일로 작성한 후 apply 적용하는 것이 좋다.

---

오브젝트란
쿠버네티스를 사용하는 관점에서 파드와 디플로이먼트는 스펙과 상태 등의 값을 가지고 있다.
이러한 값을 가지고 있는 파드와 디플로이먼트를 개별 속성을 포함해 부르는 단위를 오브젝트라고 한다.

쿠버네티스의 기본 오브젝트는 다음 4가지이다.
1. 파드
쿠버네티스에서 실행되는 최소 단위, 웹 서비스를 구동하는 데 필요한 최소 단위.
독립적인 공간과 사용 가능한 IP를 가지고 있다.
1개 이상의 컨테이너를 갖고 있기 때문에 여러 기능을 묶어 하나의 목적으로 사용할 수도 있다.
2. 네임스페이스
리소스들을 구분해 관리하는 그룹
기본으로 default, 쿠버네티스 시스템의 kube-system 등이 있다.
3. 볼륨
파드가 생성될 때 파드에서 사용할 수 있는 디렉토리를 제공한다. 하지만 파드는 언제든지 사라질 수 있는 개념이다. 즉 파드가 사용하는 디렉토리도 같이 사라질 수 있다.
그러나 파드가 사라지는 것과 별개로 보전되어야하거나 다른 파드와 공유하기 위해 사용되는 디렉토리가 볼륨이다.
4. 서비스
파드는 클러스터 내에서 유동적이기 때문에 접속 정보가 고정이 아니다.
그러나 외부에서 연결해서 들어오기 위해서는 고정된 ip가 필요
서비스는 파드의 접속을 안정적으로 유지할 수 있도록 서비스를 통해 내/외부로 연결시켜주는 역할
